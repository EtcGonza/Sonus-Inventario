import{a as ue}from"./chunk-JD3UXAGU.js";import"./chunk-E6WIJYGD.js";import{a as ce}from"./chunk-YALXNCVK.js";import{b as te,d as M,e as N,h as I}from"./chunk-UHXNRV65.js";import"./chunk-GLYNVZRA.js";import{a as D}from"./chunk-BBU5S45I.js";import"./chunk-RR733YBY.js";import{a as A,b as _,c as L,d as ie,e as G,f as re,g as oe,h as ne,i as ae,j as le,k as me,l as se,m as T,n as V,o as O,p as de,q as pe,r as $}from"./chunk-HPRGVJKF.js";import{$a as E,B as j,C as z,Ea as w,Ib as F,Lb as k,Ra as J,S as b,T as x,Ta as K,U as H,Ua as Q,V as W,Va as v,Wa as g,Xa as s,Ya as i,Za as e,_a as p,ab as c,bb as h,fb as X,gb as r,hb as R,ib as f,j as P,jb as Y,kb as Z,n as q,nb as ee,o as U,ob as y,pb as S,ra as l,za as d}from"./chunk-6DWSO5LZ.js";var Se=n=>[n,"edit"],_e=(n,o)=>o.id;function Ce(n,o){if(n&1){let t=E();i(0,"tr",25),c("click",function(){let m=b(t).$implicit,u=h();return x(u.goToDetail(m.id))}),i(1,"td",26)(2,"div",27),r(3),e()(),i(4,"td",28)(5,"div",29),r(6),e()(),i(7,"td",26)(8,"span",30),r(9),e()(),i(10,"td",26)(11,"span",31),r(12),y(13,"statusLabel"),e()(),i(14,"td",32)(15,"a",33),c("click",function(m){return b(t),x(m.stopPropagation())}),r(16,"Editar"),e()()()}if(n&2){let t=o.$implicit;l(3),R(t.nombre),l(2),s("title",Z(t.descripcion)),l(),f(" ",t.descripcion||"-"," "),l(3),f(" ",t.materiales.length," items "),l(2),X("bg-green-100",t.estado==="active")("text-green-800",t.estado==="active")("bg-yellow-100",t.estado==="draft")("text-yellow-800",t.estado==="draft")("bg-gray-100",t.estado==="disabled")("text-gray-800",t.estado==="disabled"),l(),f(" ",S(13,19,t.estado)," "),l(3),s("routerLink",ee(21,Se,t.id))}}function we(n,o){n&1&&(i(0,"tr")(1,"td",34),r(2," No hay recetas registradas. "),e()())}var B=class n{constructor(o,t){this.recipeService=o;this.router=t}recipes$;filteredRecipes$;searchControl=new G("",{nonNullable:!0});statusControl=new G("",{nonNullable:!0});ngOnInit(){this.recipes$=this.recipeService.getAll(),this.filteredRecipes$=U([this.recipes$,this.searchControl.valueChanges.pipe(j("")),this.statusControl.valueChanges.pipe(j(""))]).pipe(q(([o,t,a])=>o.filter(m=>{let u=m.nombre.toLowerCase().includes(t.toLowerCase()),fe=a===""||m.estado===a;return u&&fe})))}goToDetail(o){this.router.navigate(["/recipes",o,"edit"])}static \u0275fac=function(t){return new(t||n)(d(D),d(M))};static \u0275cmp=w({type:n,selectors:[["app-recipe-list"]],decls:44,vars:5,consts:[[1,"container","mx-auto","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-slate-800"],["routerLink","new",1,"bg-primary-600","hover:bg-primary-700","text-white","font-medium","py-2","px-4","rounded-lg","transition-colors","duration-200"],[1,"bg-white","shadow-md","rounded-lg","overflow-hidden","border","border-slate-200"],[1,"p-4","bg-slate-50","border-b","border-slate-200","flex","flex-wrap","gap-4"],[1,"flex-grow","max-w-sm"],[1,"sr-only"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Buscar por nombre...",1,"block","w-full","pl-10","pr-3","py-2","border","border-slate-300","rounded-md","leading-5","bg-white","placeholder-slate-500","focus:outline-none","focus:ring-1","focus:ring-primary-500","focus:border-primary-500","sm:text-sm",3,"formControl"],[1,"w-48"],[1,"block","w-full","py-2","px-3","border","border-slate-300","bg-white","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","sm:text-sm",3,"formControl"],["value",""],["value","active"],["value","draft"],["value","disabled"],[1,"min-w-full","divide-y","divide-slate-200"],[1,"bg-slate-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-slate-500","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-slate-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-slate-200"],[1,"hover:bg-slate-50","transition-colors","duration-150","cursor-pointer"],[1,"hover:bg-slate-50","transition-colors","duration-150","cursor-pointer",3,"click"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-slate-900"],[1,"px-6","py-4"],[1,"text-sm","text-slate-500","truncate","max-w-xs",3,"title"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-primary-600","hover:text-primary-900","mr-4",3,"click","routerLink"],["colspan","5",1,"px-6","py-4","text-center","text-slate-500"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Recetas (BOM)"),e(),i(4,"a",3),r(5," + Nueva Receta "),e()(),i(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),r(10,"Buscar receta"),e(),i(11,"div",8)(12,"div",9),H(),i(13,"svg",10),p(14,"path",11),e()(),W(),p(15,"input",12),e()(),i(16,"div",13)(17,"select",14)(18,"option",15),r(19,"Todos los estados"),e(),i(20,"option",16),r(21,"Activo"),e(),i(22,"option",17),r(23,"Borrador"),e(),i(24,"option",18),r(25,"Deshabilitado"),e()()()(),i(26,"table",19)(27,"thead",20)(28,"tr")(29,"th",21),r(30,"Nombre"),e(),i(31,"th",21),r(32,"Descripci\xF3n"),e(),i(33,"th",21),r(34,"Materiales"),e(),i(35,"th",21),r(36,"Estado"),e(),i(37,"th",22),r(38,"Acciones"),e()()(),i(39,"tbody",23),v(40,Ce,17,23,"tr",24,_e,!1,we,3,0,"tr"),y(43,"async"),e()()()()),t&2&&(l(15),s("formControl",a.searchControl),l(2),s("formControl",a.statusControl),l(23),g(S(43,3,a.filteredRecipes$)))},dependencies:[k,I,N,$,V,O,A,T,L,ne,F,ce],encapsulation:2})};var Ee=(n,o)=>o.id;function Re(n,o){n&1&&(i(0,"div")(1,"label",20),r(2,"Estado"),e(),i(3,"select",21)(4,"option",22),r(5,"Borrador"),e(),i(6,"option",23),r(7,"Activo"),e(),i(8,"option",24),r(9,"Deshabilitado"),e()()())}function Fe(n,o){if(n&1&&(i(0,"option",29),r(1),e()),n&2){let t=o.$implicit;s("value",t.id),l(),Y("",t.nombre," (",t.unidad,")")}}function ke(n,o){if(n&1){let t=E();i(0,"div",15)(1,"div",25)(2,"label",26),r(3,"Material"),e(),i(4,"select",27)(5,"option",28),r(6,"Seleccionar Material"),e(),v(7,Fe,2,3,"option",29,Ee),y(9,"async"),e()(),i(10,"div",30)(11,"label",26),r(12,"Cantidad"),e(),p(13,"input",31),e(),i(14,"div",32)(15,"label",26),r(16,"Unidad"),e(),p(17,"input",33),e(),i(18,"div",34)(19,"button",35),c("click",function(){let m=b(t).$index,u=h();return x(u.removeMaterial(m))}),i(20,"span",36),r(21,"Eliminar"),e(),r(22," \xD7 "),e()()()}if(n&2){let t=o.$index,a=h();s("formGroupName",t),l(7),g(S(9,1,a.materials$))}}function Me(n,o){n&1&&(i(0,"div",16),r(1," No hay materiales en esta receta. A\xF1ade uno. "),e())}var C=class n{constructor(o,t,a,m,u){this.fb=o;this.recipeService=t;this.materialService=a;this.router=m;this.route=u;this.recipeForm=this.fb.group({nombre:["",_.required],descripcion:[""],materiales:this.fb.array([]),estado:["draft"]})}recipeForm;isEditing=!1;recipeId=null;materials$;ngOnInit(){this.materials$=this.materialService.getAll(),this.route.paramMap.pipe(z(o=>{let t=o.get("id");return t?(this.isEditing=!0,this.recipeId=t,this.recipeService.getById(t)):P(null)})).subscribe(o=>{o?(this.recipeForm.patchValue({nombre:o.nombre,descripcion:o.descripcion,estado:o.estado}),o.materiales.forEach(t=>{this.addMaterial(t.material_id,t.cantidad_requerida,t.unidad)})):this.isEditing})}get materiales(){return this.recipeForm.get("materiales")}addMaterial(o="",t=1,a=""){let m=this.fb.group({material_id:[o,_.required],cantidad_requerida:[t,[_.required,_.min(.001)]],unidad:[a]});this.materiales.push(m)}removeMaterial(o){this.materiales.removeAt(o)}onSubmit(){if(this.recipeForm.invalid)return;let o=this.recipeForm.value;this.isEditing&&this.recipeId?this.recipeService.update(this.recipeId,o).subscribe(()=>{this.router.navigate(["/recipes"])}):this.recipeService.create(o).subscribe(()=>{this.router.navigate(["/recipes"])})}static \u0275fac=function(t){return new(t||n)(d(pe),d(D),d(ue),d(M),d(te))};static \u0275cmp=w({type:n,selectors:[["app-recipe-form"]],decls:33,vars:6,consts:[[1,"container","mx-auto","p-6","max-w-4xl"],[1,"mb-6"],["routerLink","/recipes",1,"text-primary-600","hover:text-primary-800","mb-2","inline-block"],[1,"text-3xl","font-bold","text-slate-800"],[1,"bg-white","shadow-md","rounded-lg","p-6","border","border-slate-200"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","gap-6","mb-8"],["for","nombre",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["type","text","id","nombre","formControlName","nombre",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["for","descripcion",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["id","descripcion","formControlName","descripcion","rows","2",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-slate-800"],["type","button",1,"text-sm","bg-primary-50","text-primary-700","hover:bg-primary-100","px-3","py-1","rounded-md","transition-colors",3,"click"],["formArrayName","materiales",1,"space-y-4"],[1,"flex","items-start","space-x-4","p-4","bg-slate-50","rounded-lg","border","border-slate-200",3,"formGroupName"],[1,"text-center","py-6","bg-slate-50","rounded-lg","border","border-dashed","border-slate-300","text-slate-500"],[1,"mt-8","flex","justify-end","space-x-3"],["routerLink","/recipes",1,"px-4","py-2","border","border-slate-300","rounded-md","text-slate-700","hover:bg-slate-50","transition-colors"],["type","submit",1,"px-4","py-2","bg-primary-600","text-white","rounded-md","hover:bg-primary-700","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["for","estado",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["id","estado","formControlName","estado",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["value","draft"],["value","active"],["value","disabled"],[1,"flex-grow"],[1,"block","text-xs","font-medium","text-slate-500","mb-1"],["formControlName","material_id",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["value","","disabled",""],[3,"value"],[1,"w-32"],["type","number","formControlName","cantidad_requerida","min","0","step","any",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],[1,"w-24"],["type","text","formControlName","unidad","placeholder","Unidad",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],[1,"pt-6"],["type","button",1,"text-red-600","hover:text-red-800","p-1",3,"click"],[1,"sr-only"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),r(3,"\u2190 Volver a la lista"),e(),i(4,"h1",3),r(5),e()(),i(6,"div",4)(7,"form",5),c("ngSubmit",function(){return a.onSubmit()}),i(8,"div",6)(9,"div")(10,"label",7),r(11,"Nombre de la Receta *"),e(),p(12,"input",8),e(),i(13,"div")(14,"label",9),r(15,"Descripci\xF3n"),e(),p(16,"textarea",10),e(),J(17,Re,10,0,"div"),e(),i(18,"div",1)(19,"div",11)(20,"h2",12),r(21,"Materiales (BOM)"),e(),i(22,"button",13),c("click",function(){return a.addMaterial()}),r(23," + A\xF1adir Material "),e()(),i(24,"div",14),v(25,ke,23,3,"div",15,Q,!1,Me,2,0,"div",16),e()(),i(28,"div",17)(29,"a",18),r(30,"Cancelar"),e(),i(31,"button",19),r(32),e()()()()()),t&2&&(l(5),R(a.isEditing?"Editar Receta":"Nueva Receta"),l(2),s("formGroup",a.recipeForm),l(10),K(a.isEditing?17:-1),l(8),g(a.materiales.controls),l(6),s("disabled",a.recipeForm.invalid),l(),f(" ",a.isEditing?"Actualizar":"Guardar"," "))},dependencies:[k,$,re,V,O,A,oe,T,L,ie,de,se,me,ae,le,I,N,F],encapsulation:2})};var Ze=[{path:"",component:B},{path:"new",component:C},{path:":id/edit",component:C}];export{Ze as RECIPES_ROUTES};
