import{a as E}from"./chunk-JD3UXAGU.js";import"./chunk-E6WIJYGD.js";import{a as z}from"./chunk-YALXNCVK.js";import{b as V,d as O,e as w,h as _}from"./chunk-UHXNRV65.js";import"./chunk-GLYNVZRA.js";import{a as $,b as N,c as B,d as oe,e as K,f as le,g as de,h as me,k as se,l as pe,m as P,n as j,o as G,p as ce,q as ue,r as q}from"./chunk-HPRGVJKF.js";import{$a as te,B as J,C as I,Ea as g,Hb as ae,Ib as A,Ja as ee,Jb as ne,Lb as C,Ra as h,S as k,T as F,Ta as y,U as Y,V as Z,Va as T,Wa as R,Xa as m,Ya as i,Za as t,_a as u,ab as v,bb as L,fb as f,gb as r,hb as c,ib as s,j as M,jb as ie,n as Q,nb as S,o as X,ob as x,pb as b,qb as re,ra as l,za as p}from"./chunk-6DWSO5LZ.js";var fe=o=>[o],Ce=o=>[o,"edit"],we=(o,a)=>a.id;function _e(o,a){if(o&1&&(i(0,"div",29),r(1),t()),o&2){let e=L().$implicit;l(),c(e.nota)}}function Ee(o,a){if(o&1){let e=te();i(0,"tr",25),v("click",function(){let d=k(e).$implicit,W=L();return F(W.goToDetail(d.id))}),i(1,"td",26)(2,"div",27)(3,"a",28),v("click",function(d){return k(e),F(d.stopPropagation())}),r(4),t()(),h(5,_e,2,1,"div",29),t(),i(6,"td",26)(7,"div",30),r(8),i(9,"span",31),r(10),t()()(),i(11,"td",26)(12,"span",32),r(13),x(14,"statusLabel"),t()(),i(15,"td",33)(16,"a",34),v("click",function(d){return k(e),F(d.stopPropagation())}),r(17,"Detalle"),t(),i(18,"a",35),v("click",function(d){return k(e),F(d.stopPropagation())}),r(19,"Editar"),t()()()}if(o&2){let e=a.$implicit;l(3),m("routerLink",S(22,fe,e.id)),l(),c(e.nombre),l(),y(e.nota?5:-1),l(3),s("",e.cantidad," "),l(2),c(e.unidad),l(2),f("bg-green-100",e.estado==="active")("text-green-800",e.estado==="active")("bg-yellow-100",e.estado==="draft")("text-yellow-800",e.estado==="draft")("bg-gray-100",e.estado==="disabled")("text-gray-800",e.estado==="disabled"),l(),s(" ",b(14,20,e.estado)," "),l(3),m("routerLink",S(24,fe,e.id)),l(2),m("routerLink",S(26,Ce,e.id))}}function Me(o,a){o&1&&(i(0,"tr")(1,"td",36),r(2," No hay materiales registrados. "),t()())}var H=class o{constructor(a,e){this.materialService=a;this.router=e}materials$;filteredMaterials$;searchControl=new K("",{nonNullable:!0});statusControl=new K("",{nonNullable:!0});ngOnInit(){this.materials$=this.materialService.getAll(),this.filteredMaterials$=X([this.materials$,this.searchControl.valueChanges.pipe(J("")),this.statusControl.valueChanges.pipe(J(""))]).pipe(Q(([a,e,n])=>a.filter(d=>{let W=d.nombre.toLowerCase().includes(e.toLowerCase()),he=n===""||d.estado===n;return W&&he})))}goToDetail(a){this.router.navigate(["/materials",a])}static \u0275fac=function(e){return new(e||o)(p(E),p(O))};static \u0275cmp=g({type:o,selectors:[["app-material-list"]],decls:42,vars:5,consts:[[1,"container","mx-auto","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold","text-slate-800"],["routerLink","new",1,"bg-primary-600","hover:bg-primary-700","text-white","font-medium","py-2","px-4","rounded-lg","transition-colors","duration-200"],[1,"bg-white","shadow-md","rounded-lg","overflow-hidden","border","border-slate-200"],[1,"p-4","bg-slate-50","border-b","border-slate-200","flex","flex-wrap","gap-4"],[1,"flex-grow","max-w-sm"],[1,"sr-only"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Buscar por nombre...",1,"block","w-full","pl-10","pr-3","py-2","border","border-slate-300","rounded-md","leading-5","bg-white","placeholder-slate-500","focus:outline-none","focus:ring-1","focus:ring-primary-500","focus:border-primary-500","sm:text-sm",3,"formControl"],[1,"w-48"],[1,"block","w-full","py-2","px-3","border","border-slate-300","bg-white","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","sm:text-sm",3,"formControl"],["value",""],["value","active"],["value","draft"],["value","disabled"],[1,"min-w-full","divide-y","divide-slate-200"],[1,"bg-slate-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-slate-500","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-slate-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-slate-200"],[1,"hover:bg-slate-50","transition-colors","duration-150","cursor-pointer"],[1,"hover:bg-slate-50","transition-colors","duration-150","cursor-pointer",3,"click"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-slate-900"],[1,"hover:text-primary-600","hover:underline",3,"click","routerLink"],[1,"text-xs","text-slate-500"],[1,"text-sm","text-slate-900"],[1,"text-slate-500","text-xs"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-primary-600","hover:text-primary-900","mr-4",3,"click","routerLink"],[1,"text-slate-600","hover:text-slate-900","mr-4",3,"click","routerLink"],["colspan","4",1,"px-6","py-4","text-center","text-slate-500"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Materiales"),t(),i(4,"a",3),r(5," + Nuevo Material "),t()(),i(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),r(10,"Buscar material"),t(),i(11,"div",8)(12,"div",9),Y(),i(13,"svg",10),u(14,"path",11),t()(),Z(),u(15,"input",12),t()(),i(16,"div",13)(17,"select",14)(18,"option",15),r(19,"Todos los estados"),t(),i(20,"option",16),r(21,"Activo"),t(),i(22,"option",17),r(23,"Borrador"),t(),i(24,"option",18),r(25,"Deshabilitado"),t()()()(),i(26,"table",19)(27,"thead",20)(28,"tr")(29,"th",21),r(30,"Nombre"),t(),i(31,"th",21),r(32,"Cantidad"),t(),i(33,"th",21),r(34,"Estado"),t(),i(35,"th",22),r(36,"Acciones"),t()()(),i(37,"tbody",23),T(38,Ee,20,28,"tr",24,we,!1,Me,3,0,"tr"),x(41,"async"),t()()()()),e&2&&(l(15),m("formControl",n.searchControl),l(2),m("formControl",n.statusControl),l(21),R(b(41,3,n.filteredMaterials$)))},dependencies:[C,_,w,q,j,G,$,P,B,me,A,z],encapsulation:2})};function Ie(o,a){o&1&&(i(0,"p",9),r(1,"El nombre es requerido."),t())}function ke(o,a){o&1&&(i(0,"p",9),r(1,"La unidad es requerida."),t())}function Fe(o,a){o&1&&(i(0,"div")(1,"label",20),r(2,"Estado"),t(),i(3,"select",21)(4,"option",22),r(5,"Borrador"),t(),i(6,"option",23),r(7,"Activo"),t(),i(8,"option",24),r(9,"Deshabilitado"),t()()())}var D=class o{constructor(a,e,n,d){this.fb=a;this.materialService=e;this.router=n;this.route=d;this.materialForm=this.fb.group({nombre:["",N.required],cantidad:[0,[N.required,N.min(0)]],unidad:["",N.required],nota:[""],estado:["draft"]})}materialForm;isEditing=!1;materialId=null;ngOnInit(){this.route.paramMap.pipe(I(a=>{let e=a.get("id");return e?(this.isEditing=!0,this.materialId=e,this.materialService.getById(e)):M(null)})).subscribe(a=>{a&&this.materialForm.patchValue({nombre:a.nombre,cantidad:a.cantidad,unidad:a.unidad,nota:a.nota,estado:a.estado})})}get nombre(){return this.materialForm.get("nombre")}get unidad(){return this.materialForm.get("unidad")}onSubmit(){if(this.materialForm.invalid)return;let a=this.materialForm.value;this.isEditing&&this.materialId?this.materialService.update(this.materialId,a).subscribe(()=>{this.router.navigate(["/materials"])}):this.materialService.create(a).subscribe(()=>{this.router.navigate(["/materials"])})}static \u0275fac=function(e){return new(e||o)(p(ue),p(E),p(O),p(V))};static \u0275cmp=g({type:o,selectors:[["app-material-form"]],decls:34,vars:9,consts:[[1,"container","mx-auto","p-6","max-w-2xl"],[1,"mb-6"],["routerLink","/materials",1,"text-primary-600","hover:text-primary-800","mb-2","inline-block"],[1,"text-3xl","font-bold","text-slate-800"],[1,"bg-white","shadow-md","rounded-lg","p-6","border","border-slate-200"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","gap-6"],["for","nombre",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["type","text","id","nombre","formControlName","nombre",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],[1,"text-red-500","text-xs","mt-1"],[1,"grid","grid-cols-2","gap-4"],["for","cantidad",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["type","number","id","cantidad","formControlName","cantidad","min","0",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["for","unidad",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["type","text","id","unidad","formControlName","unidad","placeholder","ej. unidad, metros",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["for","nota",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["id","nota","formControlName","nota","rows","3",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],[1,"mt-8","flex","justify-end","space-x-3"],["routerLink","/materials",1,"px-4","py-2","border","border-slate-300","rounded-md","text-slate-700","hover:bg-slate-50","transition-colors"],["type","submit",1,"px-4","py-2","bg-primary-600","text-white","rounded-md","hover:bg-primary-700","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["for","estado",1,"block","text-sm","font-medium","text-slate-700","mb-1"],["id","estado","formControlName","estado",1,"w-full","rounded-md","border-slate-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","p-2","border"],["value","draft"],["value","active"],["value","disabled"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),r(3,"\u2190 Volver a la lista"),t(),i(4,"h1",3),r(5),t()(),i(6,"div",4)(7,"form",5),v("ngSubmit",function(){return n.onSubmit()}),i(8,"div",6)(9,"div")(10,"label",7),r(11,"Nombre *"),t(),u(12,"input",8),h(13,Ie,2,0,"p",9),t(),i(14,"div",10)(15,"div")(16,"label",11),r(17,"Cantidad Inicial"),t(),u(18,"input",12),t(),i(19,"div")(20,"label",13),r(21,"Unidad *"),t(),u(22,"input",14),h(23,ke,2,0,"p",9),t()(),i(24,"div")(25,"label",15),r(26,"Nota"),t(),u(27,"textarea",16),t(),h(28,Fe,10,0,"div"),t(),i(29,"div",17)(30,"a",18),r(31,"Cancelar"),t(),i(32,"button",19),r(33),t()()()()()),e&2&&(l(5),c(n.isEditing?"Editar Material":"Nuevo Material"),l(2),m("formGroup",n.materialForm),l(5),f("border-red-500",(n.nombre==null?null:n.nombre.invalid)&&((n.nombre==null?null:n.nombre.dirty)||(n.nombre==null?null:n.nombre.touched))),l(),y(n.nombre!=null&&n.nombre.invalid&&(n.nombre!=null&&n.nombre.dirty||n.nombre!=null&&n.nombre.touched)?13:-1),l(10),y(n.unidad!=null&&n.unidad.invalid&&(n.unidad!=null&&n.unidad.dirty||n.unidad!=null&&n.unidad.touched)?23:-1),l(5),y(n.isEditing?28:-1),l(4),m("disabled",n.materialForm.invalid),l(),s(" ",n.isEditing?"Actualizar":"Guardar"," "))},dependencies:[C,q,le,j,G,$,de,P,B,oe,ce,pe,se,_,w],encapsulation:2})};var Le=o=>["/materials",o,"edit"],Ne=(o,a)=>a.id;function De(o,a){if(o&1&&(i(0,"tr")(1,"td",20),r(2),x(3,"date"),t(),i(4,"td",21)(5,"span",22),r(6),t()(),i(7,"td",23),r(8),t(),i(9,"td",24),r(10),t()()),o&2){let e=a.$implicit;l(2),s(" ",re(3,13,e.timestamp,"short")," "),l(3),f("text-green-600",e.cantidad>0)("text-red-600",e.cantidad<0),l(),s(" ",e.tipo," "),l(),f("text-green-600",e.cantidad>0)("text-red-600",e.cantidad<0),l(),ie(" ",e.cantidad>0?"+":"","",e.cantidad," "),l(2),s(" ",e.nota||"-"," ")}}function Te(o,a){o&1&&(i(0,"tr")(1,"td",25),r(2,"Sin movimientos registrados."),t()())}function Re(o,a){if(o&1&&(i(0,"div",1)(1,"div",2)(2,"div")(3,"a",3),r(4,"\u2190 Volver a la lista"),t(),i(5,"h1",4),r(6),t(),i(7,"span",5),r(8),t()(),i(9,"div",6)(10,"a",7),r(11,"Editar"),t()()(),i(12,"div",8)(13,"div",9)(14,"h3",10),r(15,"Cantidad Actual"),t(),i(16,"p",11),r(17),i(18,"span",5),r(19),t()()(),i(20,"div",9)(21,"h3",10),r(22,"Estado"),t(),i(23,"span",12),r(24),x(25,"statusLabel"),t()()(),i(26,"div",13)(27,"div",14)(28,"h2",15),r(29,"Historial de Movimientos"),t()(),i(30,"table",16)(31,"thead",17)(32,"tr")(33,"th",18),r(34,"Fecha"),t(),i(35,"th",18),r(36,"Tipo"),t(),i(37,"th",18),r(38,"Cantidad"),t(),i(39,"th",18),r(40,"Nota"),t()()(),i(41,"tbody",19),T(42,De,11,16,"tr",null,Ne,!1,Te,3,0,"tr"),x(45,"async"),t()()()()),o&2){let e=a.ngIf,n=L();l(6),c(e.nombre),l(2),s("ID: ",e.id),l(2),m("routerLink",S(23,Le,e.id)),l(7),s("",e.cantidad," "),l(2),c(e.unidad),l(4),f("bg-green-100",e.estado==="active")("text-green-800",e.estado==="active")("bg-yellow-100",e.estado==="draft")("text-yellow-800",e.estado==="draft")("bg-gray-100",e.estado==="disabled")("text-gray-800",e.estado==="disabled"),l(),s(" ",b(25,19,e.estado)," "),l(18),R(b(45,21,n.history$))}}var U=class o{constructor(a,e){this.route=a;this.materialService=e}material$;history$;ngOnInit(){this.material$=this.route.paramMap.pipe(I(a=>{let e=a.get("id");return e?this.materialService.getById(e):M(void 0)})),this.history$=this.route.paramMap.pipe(I(a=>{let e=a.get("id");return e?this.materialService.getHistory(e):M([])}))}static \u0275fac=function(e){return new(e||o)(p(V),p(E))};static \u0275cmp=g({type:o,selectors:[["app-material-detail"]],decls:2,vars:3,consts:[["class","container mx-auto p-6 max-w-4xl",4,"ngIf"],[1,"container","mx-auto","p-6","max-w-4xl"],[1,"mb-6","flex","justify-between","items-center"],["routerLink","/materials",1,"text-primary-600","hover:text-primary-800","mb-2","inline-block"],[1,"text-3xl","font-bold","text-slate-800"],[1,"text-sm","text-slate-500"],[1,"space-x-3"],[1,"bg-primary-600","text-white","px-4","py-2","rounded-md","hover:bg-primary-700","transition",3,"routerLink"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-8"],[1,"bg-white","p-6","rounded-lg","shadow","border","border-slate-200"],[1,"text-xs","font-bold","text-slate-500","uppercase","mb-1"],[1,"text-2xl","text-slate-900"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full"],[1,"bg-white","rounded-lg","shadow","border","border-slate-200","overflow-hidden"],[1,"px-6","py-4","border-b","border-slate-200","bg-slate-50"],[1,"text-lg","font-bold","text-slate-800"],[1,"min-w-full","divide-y","divide-slate-200"],[1,"bg-slate-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-slate-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-slate-200"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-slate-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"capitalize"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-bold"],[1,"px-6","py-4","text-sm","text-slate-500","max-w-xs","truncate"],["colspan","4",1,"px-6","py-4","text-center","text-slate-500"]],template:function(e,n){e&1&&(ee(0,Re,46,25,"div",0),x(1,"async")),e&2&&m("ngIf",b(1,1,n.material$))},dependencies:[C,ae,_,w,A,ne,z],encapsulation:2})};var st=[{path:"",component:H},{path:"new",component:D},{path:":id/edit",component:D},{path:":id",component:U}];export{st as MATERIALS_ROUTES};
